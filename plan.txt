ğŸ•ï¸ Product Specification: TripTrack
Domain: triptrack.site
Platform Focus: Cross-platform Mobile & Web Application
Core Value Proposition: A role-based financial utility designed to track shared expenses, handle complex group debts, and manage peer-to-peer settlement during group travel.

ğŸ› ï¸ 1. Technology Stack
Frontend Framework: Flutter (Single codebase for Android, iOS, and the Web application).

Backend & Database: Supabase (PostgreSQL). Provides a robust relational database ideal for complex financial ledger links between users, trips, and expenses.

Real-Time Sync: Supabase Realtime (Ensures UI updates instantly across Android and Web when a user adds an expense or settles a debt).

Authentication: Supabase Auth (Universal accounts supporting email/password and social logins).

ğŸ›ï¸ 2. Core Architecture & Navigation
Universal Accounts: A single authenticated user account can participate in an unlimited number of trips simultaneously across different platforms.

The Global Dashboard (Minimalist List): The home screen displays a clean, text-based list of all Active and Past trips. (Note: Premium photo cards can be added later as a paid upgrade).

Inside a Trip (Bottom Navigation): When a user enters a trip, navigation is handled via a standard Bottom Navigation Bar with three tabs:

Tab 1: Expenses (The ledger of all purchases)

Tab 2: Balances (The settlement math and leaderboard)

Tab 3: Members (The roster and role management)

ğŸ”— 3. Trip Creation & The Invite Flow
Trip Initialization: When creating a trip, the Leader must set a Trip Name, Dates, and select a Base Currency (e.g., USD, EUR, TRY). Note: The currency is permanently locked for the duration of the trip to prevent mathematical corruption.

The Join Gateway: Users join a trip via a dedicated "Join" screen offering three frictionless methods:

Scanning a QR Code generated by the Leader's app.

Entering a 6-digit Invite Code.

Clicking a Deep Link that opens the app or web platform directly.

ğŸ” 4. Role-Based Access Control (RBAC)
User permissions are strictly bound to the specific trip instance.

ğŸ‘‘ Trip Leader (The Creator):

Has absolute control over the trip instance.

Can edit/delete any expense logged by anyone.

Can manage the roster (kick users, promote/demote roles, approve exit requests).

Can lock the trip to prevent new joins, and can trigger the "Finish Trip" state.

âœï¸ Contributor (Active Participant):

Can log new expenses they paid for.

Can only edit or delete their own expenses.

Can view the full ledger and balances.

ğŸš¶ Hiker (View-Only Participant):

Cannot log, edit, or delete any expenses.

Can view the ledger and monitor their own balances.

ğŸ›¡ï¸ 5. Trip Security & Member Management
The "Lock Trip" Toggle: The Leader can freeze the roster at any time, invalidating the QR code and links so no one else can join.

Restricted Exits & The Ripple Effect: Members cannot simply press "Leave" to escape their debt.

They must submit an "Exit Request" to the Leader.

If the Leader approves the exit (or unilaterally kicks them), that user and all of their logged expenses are completely wiped from the Supabase database.

The app's math automatically recalculates the new balances for the remaining members (The Ripple Effect).

ğŸ§® 6. The Expense Engine & Uneven Splits
Adding an Expense: Handled via a Floating Action Button (+) on the Expenses tab.

Data Points: Every entry requires the Buyer, the Item Description, and the Amount.

The "Uneven Split" (Opt-Out Mechanism): By default, the app assumes 100% group participation for an expense. However, an "Advanced Options" toggle allows the creator to uncheck specific members (e.g., excluding a vegetarian from a meat purchase). The algorithm then divides the cost only among the checked participants.

ğŸš¦ 7. The Trip Lifecycle & Settlement System
To prevent chaotic math updates while people are trying to pay each other, the trip follows three strict phases:

Phase 1: Active (In Progress)

The ledger is open. The + button is active.

If users view the Balances tab, a warning banner states: "ğŸš§ Trip in progress: Balances are estimates and will change."

Balances are displayed as a Net Leaderboard (e.g., Muhammad: +$20, Hadi: -$15).

Phase 2: The "Finish Trip" Action

The vacation ends. The Leader presses "Finish & Lock Trip".

The database freezes. The + button disappears. No expenses can be added, edited, or deleted. The final math is locked in.

Phase 3: The Settlement Handshake

The Balances leaderboard becomes interactive.

Step 1: The debtor (Hadi) presses "Mark as Paid" next to his name. His status changes to Pending.

Step 2: The creditor (Ali) sees the pending payment. Once the cash is in his hand (or bank), Ali presses "Confirm Received".

Step 3: The debt drops to zero, and a green checkmark completes the transaction.